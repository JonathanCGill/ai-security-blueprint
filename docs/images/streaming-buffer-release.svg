<svg xmlns="http://www.w3.org/2000/svg" width="800" height="80" viewBox="0 0 800 80">
  <defs>
    <marker id="arrow" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#475569"/>
    </marker>
  </defs>

  <rect width="800" height="80" fill="#f8fafc"/>

  <!-- LLM -->
  <rect x="10" y="20" width="60" height="36" rx="4" fill="#fef3c7" stroke="#f59e0b" stroke-width="1.5"/>
  <text x="40" y="43" font-family="Arial, sans-serif" font-size="11" fill="#92400e" text-anchor="middle">LLM</text>

  <line x1="70" y1="38" x2="98" y2="38" stroke="#475569" stroke-width="1.5" marker-end="url(#arrow)"/>

  <!-- Buffer -->
  <rect x="100" y="20" width="140" height="36" rx="4" fill="#f1f5f9" stroke="#94a3b8" stroke-width="1.5"/>
  <text x="170" y="43" font-family="Arial, sans-serif" font-size="11" fill="#475569" text-anchor="middle">Buffer (N tokens)</text>

  <line x1="240" y1="38" x2="268" y2="38" stroke="#475569" stroke-width="1.5" marker-end="url(#arrow)"/>

  <!-- Guardrail check -->
  <rect x="270" y="20" width="140" height="36" rx="4" fill="#dcfce7" stroke="#22c55e" stroke-width="1.5"/>
  <text x="340" y="43" font-family="Arial, sans-serif" font-size="11" fill="#166534" text-anchor="middle">Guardrail check</text>

  <line x1="410" y1="38" x2="438" y2="38" stroke="#475569" stroke-width="1.5" marker-end="url(#arrow)"/>

  <!-- Release -->
  <rect x="440" y="20" width="150" height="36" rx="4" fill="#e0e7ff" stroke="#6366f1" stroke-width="1.5"/>
  <text x="515" y="43" font-family="Arial, sans-serif" font-size="11" fill="#4338ca" text-anchor="middle">Release to client</text>

  <line x1="590" y1="38" x2="618" y2="38" stroke="#475569" stroke-width="1.5" marker-end="url(#arrow)"/>

  <!-- Repeat -->
  <rect x="620" y="20" width="155" height="36" rx="4" fill="#f1f5f9" stroke="#94a3b8" stroke-width="1.5" stroke-dasharray="5,3"/>
  <text x="697" y="43" font-family="Arial, sans-serif" font-size="11" fill="#64748b" text-anchor="middle" font-style="italic">Buffer next N ...</text>
</svg>
